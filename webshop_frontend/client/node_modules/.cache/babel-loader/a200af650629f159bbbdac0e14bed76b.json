{"ast":null,"code":"var _jsxFileName = \"D:\\\\repos\\\\webshop_react\\\\webshop_frontend\\\\client\\\\src\\\\App\\\\pages\\\\CartPage.js\";\nimport React, { Component } from 'react';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport { ToastContainer } from 'react-toastify';\nimport { toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.min.css';\n\nclass CartPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getProducts = () => {\n      if (localStorage.length) {\n        let localCart = localStorage.getItem('cart');\n        localCart = JSON.parse(localCart);\n        let ids = [];\n\n        for (let i = 0; i < localCart.length; i++) {\n          ids.push(localCart[i].id);\n        }\n\n        let url = `/getProductsById?id=${ids.join('-')}`;\n        fetch(url).then(res => res.json()).then(products => this.setState({\n          products: products\n        }));\n      } else {\n        this.setState({\n          products: []\n        });\n      }\n    };\n\n    this.removeProduct = id => {\n      let localCart = localStorage.getItem('cart');\n      localCart = JSON.parse(localCart);\n      console.log(localCart);\n      let current = localCart.map(function (e) {\n        return e.id;\n      }).indexOf(id);\n      console.log(`id:${id}, current: ${current}`);\n      localCart.splice(current, 1);\n\n      if (localCart.length) {\n        localStorage.setItem('cart', JSON.stringify(localCart));\n      } else {\n        localStorage.clear();\n      }\n\n      this.getProducts();\n    };\n\n    this.customToast = name => {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, \"removed \", React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, name), \" from shopping cart!\");\n    };\n\n    this.handleRemove = (id, name) => {\n      this.removeProduct(id);\n      toast.info(this.customToast(name));\n    };\n\n    this.removeAll = () => {\n      localStorage.clear();\n      this.getProducts();\n    };\n\n    this.state = {\n      products: null\n    };\n  }\n\n  componentDidMount() {\n    this.getProducts();\n  }\n\n  render() {\n    console.log(this.state.products);\n\n    if (!this.state.products) {\n      return React.createElement(\"div\", {\n        className: \"loader-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"preloader-wrapper big active\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"spinner-layer spinner-blue-only\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"circle-clipper left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"circle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"gap-patch\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"circle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"circle-clipper right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"circle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })))));\n    }\n\n    const {\n      products\n    } = this.state;\n    let localCart = localStorage.getItem('cart');\n    localCart = JSON.parse(localCart);\n\n    for (let i = 0; i < products.length; i++) {\n      let current = products.map(function (e) {\n        return e.id;\n      }).indexOf(localCart[i].id);\n      products[current].amount = localCart[i].amount;\n    }\n\n    console.log(products);\n    return React.createElement(\"div\", {\n      className: \"row\",\n      id: \"cart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, localStorage.length ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(TableContainer, {\n      component: Paper,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(Table, {\n      className: \"cartTable\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, React.createElement(\"caption\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: this.removeAll,\n      variant: \"contained\",\n      className: \"button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, \"Empty cart\")), React.createElement(TableHead, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(TableRow, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(TableCell, {\n      className: \"tableHead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }), React.createElement(TableCell, {\n      className: \"tableHead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(TableCell, {\n      className: \"tableHead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"Name \"), React.createElement(TableCell, {\n      align: \"center\",\n      className: \"tableHead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"Quantity \"), React.createElement(TableCell, {\n      align: \"center\",\n      className: \"tableHead\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, \"Price \"))), React.createElement(TableBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, products.map(product => React.createElement(TableRow, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      onClick: () => this.handleRemove(product.id, product.name),\n      class: \"material-icons removeItem\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"close\")), React.createElement(TableCell, {\n      component: \"th\",\n      align: \"center\",\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: require(`../../assets/images/${product.image}`),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    })), React.createElement(TableCell, {\n      component: \"th\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, product.name), React.createElement(TableCell, {\n      component: \"th\",\n      align: \"center\",\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, product.amount), React.createElement(TableCell, {\n      align: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, product.price)))))), React.createElement(ToastContainer, {\n      autoClose: 4000,\n      position: \"bottom-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })) : React.createElement(\"div\", {\n      id: \"emptyCart\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"emptyCartIcon\",\n      class: \"material-icons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, \"remove_shopping_cart\"), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \"Cart is empty\")));\n  }\n\n}\n\nexport default CartPage;","map":{"version":3,"sources":["D:/repos/webshop_react/webshop_frontend/client/src/App/pages/CartPage.js"],"names":["React","Component","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","Button","ToastContainer","toast","CartPage","constructor","props","getProducts","localStorage","length","localCart","getItem","JSON","parse","ids","i","push","id","url","join","fetch","then","res","json","products","setState","removeProduct","console","log","current","map","e","indexOf","splice","setItem","stringify","clear","customToast","name","handleRemove","info","removeAll","state","componentDidMount","render","amount","product","require","image","price"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Button from '@material-ui/core/Button';\r\nimport { ToastContainer } from 'react-toastify';\r\nimport { toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.min.css';\r\n\r\nclass CartPage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            products: null\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getProducts();\r\n    }\r\n\r\n    getProducts = () => {\r\n        if (localStorage.length) {\r\n            let localCart = localStorage.getItem('cart')\r\n            localCart = JSON.parse(localCart)\r\n            let ids = []\r\n            for (let i = 0; i < localCart.length; i++) {\r\n                ids.push(localCart[i].id)\r\n            }\r\n            let url = `/getProductsById?id=${ids.join('-')}`\r\n            fetch(url)\r\n                .then(res => res.json())\r\n                .then(products => this.setState({ products: products }))\r\n        } else {\r\n            this.setState({ products: [] })\r\n        }\r\n    }\r\n\r\n    removeProduct = (id) => {\r\n        let localCart = localStorage.getItem('cart')\r\n        localCart = JSON.parse(localCart)\r\n        console.log(localCart);\r\n\r\n        let current = localCart.map(function (e) { return e.id; }).indexOf(id)\r\n        console.log(`id:${id}, current: ${current}`);\r\n        localCart.splice(current, 1)\r\n        if (localCart.length) {\r\n            localStorage.setItem('cart', JSON.stringify(localCart))\r\n        } else {\r\n            localStorage.clear();\r\n        }\r\n        this.getProducts()\r\n    }\r\n\r\n    customToast = (name) => {\r\n        return (\r\n            <div>\r\n                removed <span>{name}</span> from shopping cart!\r\n            </div>\r\n        )\r\n    }\r\n\r\n    handleRemove = (id, name) => {\r\n        this.removeProduct(id)\r\n        toast.info(this.customToast(name));\r\n    }\r\n\r\n    removeAll = () => {\r\n        localStorage.clear();\r\n        this.getProducts()\r\n    }\r\n\r\n    render() {\r\n        console.log(this.state.products);\r\n\r\n        if (!this.state.products) {\r\n            return <div className=\"loader-wrapper\">\r\n                <div className=\"preloader-wrapper big active\">\r\n                    <div className=\"spinner-layer spinner-blue-only\">\r\n                        <div className=\"circle-clipper left\">\r\n                            <div className=\"circle\"></div>\r\n                        </div><div className=\"gap-patch\">\r\n                            <div className=\"circle\"></div>\r\n                        </div><div className=\"circle-clipper right\">\r\n                            <div className=\"circle\"></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        }\r\n\r\n        const { products } = this.state\r\n        let localCart = localStorage.getItem('cart')\r\n        localCart = JSON.parse(localCart)\r\n\r\n        for (let i = 0; i < products.length; i++) {\r\n            let current = products.map(function (e) { return e.id; }).indexOf(localCart[i].id)\r\n            products[current].amount = localCart[i].amount\r\n        }\r\n        console.log(products);\r\n\r\n        return (\r\n            <div className=\"row\" id=\"cart\">\r\n                {\r\n                    localStorage.length ? (\r\n                        <div>\r\n                            <TableContainer component={Paper}>\r\n                                <Table className=\"cartTable\">\r\n                                    <caption><Button onClick={this.removeAll} variant=\"contained\" className=\"button\">\r\n                                        Empty cart\r\n                                    </Button>\r\n                                    </caption>\r\n                                    <TableHead>\r\n                                        <TableRow>\r\n                                            <TableCell className=\"tableHead\"></TableCell>\r\n                                            <TableCell className=\"tableHead\"></TableCell>\r\n                                            <TableCell className=\"tableHead\">Name </TableCell>\r\n                                            <TableCell align=\"center\" className=\"tableHead\">Quantity </TableCell>\r\n                                            <TableCell align=\"center\" className=\"tableHead\">Price </TableCell>\r\n                                        </TableRow>\r\n                                    </TableHead>\r\n                                    <TableBody>\r\n                                        {products.map(product => (\r\n                                            <TableRow>\r\n                                                <TableCell>\r\n                                                    <i onClick={() => this.handleRemove(product.id, product.name)} class=\"material-icons removeItem\">\r\n                                                        close\r\n                                                    </i>\r\n                                                </TableCell>\r\n                                                <TableCell component=\"th\" align=\"center\" scope=\"row\"><img src={require(`../../assets/images/${product.image}`)} /></TableCell>\r\n                                                <TableCell component=\"th\">{product.name}</TableCell>\r\n                                                <TableCell component=\"th\" align=\"center\" scope=\"row\">{product.amount}</TableCell>\r\n                                                <TableCell align=\"center\">{product.price}</TableCell>\r\n                                            </TableRow>\r\n                                        ))}\r\n                                    </TableBody>\r\n                                </Table>\r\n                            </TableContainer>\r\n                            <ToastContainer autoClose={4000} position=\"bottom-right\" />\r\n                        </div>\r\n                    )\r\n                        : (<div id=\"emptyCart\"><div id=\"emptyCartIcon\" class=\"material-icons\">\r\n                            remove_shopping_cart\r\n                            </div>\r\n                            <h3>Cart is empty</h3>\r\n                        </div>\r\n                        )}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CartPage"]},"metadata":{},"sourceType":"module"}